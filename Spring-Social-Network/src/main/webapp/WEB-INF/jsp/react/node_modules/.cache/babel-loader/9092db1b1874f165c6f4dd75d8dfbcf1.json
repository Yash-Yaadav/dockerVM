{"ast":null,"code":"import _regeneratorRuntime from\"/root/Spring-Social-Network/src/main/webapp/WEB-INF/jsp/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/root/Spring-Social-Network/src/main/webapp/WEB-INF/jsp/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/root/Spring-Social-Network/src/main/webapp/WEB-INF/jsp/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{CurrentUserContext}from\"./Navbar\";import{useHistory}from\"react-router-dom\";import Axios from\"axios\";import TimeAgo from'react-timeago';// function fetchData() {\n//     fetch('/getcityfromcountry/7', {mode: \"cors\"})\n//         .then(response => response.json())\n//         .then(data => console.log(data));\n// }\nvar style={objectFit:'cover',borderRadius:'50%',width:'40px',height:'40px'};function Comment(props){var _React$useState=React.useState(new Date()),_React$useState2=_slicedToArray(_React$useState,2),dateTime=_React$useState2[0],setDateTime=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),editable=_React$useState4[0],setEditable=_React$useState4[1];var _React$useState5=React.useState(props.comment.text),_React$useState6=_slicedToArray(_React$useState5,2),text=_React$useState6[0],setText=_React$useState6[1];var currentUser=React.useContext(CurrentUserContext);var history=useHistory();function deleteComment(){fetch(\"/post/removeComment\",{method:\"POST\",credentials:\"include\",headers:{commentId:props.comment.commentId}}).then(function(data){// history.push(\"/profile\");\n// history.push(\"/\");\nprops.value.setValue(!props.value.value);});}function updatePost(){return _updatePost.apply(this,arguments);}function _updatePost(){_updatePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!editable){_context.next=10;break;}_context.prev=1;_context.next=4;return Axios.post('/post/updateComment',{'text':text},{withCredentials:true,headers:{'Content-Type':'application/json',commentId:props.comment.commentId}});case 4:_context.next=10;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](1);console.log(_context.t0);setText(props.post.text);case 10:setEditable(!editable);case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,6]]);}));return _updatePost.apply(this,arguments);}function viewProfile(){if(props.comment.user.userId===currentUser.userId){history.push(\"/profile\");}else{history.push({pathname:'/ProfileAll',state:{detail:props.comment.user.userId}});}}React.useEffect(function(){var tempDate=new Date(props.comment.created);tempDate.setHours(tempDate.getHours()+3,tempDate.getMinutes(),tempDate.getSeconds(),tempDate.getMilliseconds());setDateTime(tempDate);// Delete post render\n// if (props.comment.user.userId === currentUser.userId) {\n//     document.getElementById(\"deleteButton\" + props.comment.commentId).style.display = \"block\";\n// }\n},[]);return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"card p-0 my-1 mx-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-body d-flex flex-row pt-2 pb-0 px-1 mb-0\"},/*#__PURE__*/React.createElement(\"img\",{style:style,src:\"/api/profile/searchUsers/\"+props.comment.user.userId,className:\"avatar rounded-circle mx-2\",alt:\"Cinque Terre\",onClick:viewProfile}),/*#__PURE__*/React.createElement(\"div\",{className:\"w-100\"},/*#__PURE__*/React.createElement(\"h6\",{className:\"card-text mb-0\",onClick:viewProfile,style:{cursor:\"pointer\"}},props.comment.user.firstName+\" \"+props.comment.user.lastName),/*#__PURE__*/React.createElement(\"blockquote\",{className:\"card-text p-0 m-0\"},!editable&&/*#__PURE__*/React.createElement(\"p\",{className:\"mb-0\"},text),editable&&/*#__PURE__*/React.createElement(\"textarea\",{value:text,rows:\"3\",minLength:\"1\",maxLength:\"250\",className:\"form-control\",onChange:function onChange(evt){setText(evt.target.value);}}))),props.comment.user.userId===currentUser.userId&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{onClick:updatePost,id:\"updateButton\"+props.comment.commentId,style:{cursor:\"pointer\"}},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-edit mr-2\"})),/*#__PURE__*/React.createElement(\"div\",{onClick:deleteComment,id:\"deleteButton\"+props.comment.commentId,style:{cursor:\"pointer\"},className:\"pr-2\"},/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-trash-alt\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body p-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-11 text-right\"},/*#__PURE__*/React.createElement(\"p\",{className:\"card-text text-secondary\"},/*#__PURE__*/React.createElement(\"small\",null,/*#__PURE__*/React.createElement(\"i\",{className:\"far fa-clock pr-2\"}),/*#__PURE__*/React.createElement(TimeAgo,{date:props.comment.created}))))))));}export default Comment;","map":{"version":3,"sources":["/root/Spring-Social-Network/src/main/webapp/WEB-INF/jsp/react/src/components/Comment.jsx"],"names":["React","CurrentUserContext","useHistory","Axios","TimeAgo","style","objectFit","borderRadius","width","height","Comment","props","useState","Date","dateTime","setDateTime","editable","setEditable","comment","text","setText","currentUser","useContext","history","deleteComment","fetch","method","credentials","headers","commentId","then","data","value","setValue","updatePost","post","withCredentials","console","log","viewProfile","user","userId","push","pathname","state","detail","useEffect","tempDate","created","setHours","getHours","getMinutes","getSeconds","getMilliseconds","cursor","firstName","lastName","evt","target"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { CurrentUserContext } from \"./Navbar\";\nimport {useHistory} from \"react-router-dom\";\nimport Axios from \"axios\";\nimport TimeAgo from 'react-timeago';\n\n// function fetchData() {\n//     fetch('/getcityfromcountry/7', {mode: \"cors\"})\n//         .then(response => response.json())\n//         .then(data => console.log(data));\n// }\n\nconst style = {\n    objectFit: 'cover',\n    borderRadius: '50%',\n    width: '40px',\n    height: '40px'\n};\n\nfunction Comment(props){\n\n    const [dateTime, setDateTime] = React.useState(new Date());\n    const [editable, setEditable] = React.useState(false);\n    const [text, setText] = React.useState(props.comment.text);\n    const currentUser = React.useContext(CurrentUserContext);\n    const history = useHistory();\n\n    function deleteComment() {\n        fetch(\"/post/removeComment\",{\n            method: \"POST\",\n            credentials: \"include\",\n            headers: {\n                commentId: props.comment.commentId\n            }\n        })\n            .then((data) => {\n                // history.push(\"/profile\");\n                // history.push(\"/\");\n                props.value.setValue(!props.value.value);\n            });\n    }\n\n    async function updatePost() {\n        if(editable) {\n            try {\n                await Axios.post(\n                    '/post/updateComment',\n                    {\n                        'text': text\n                    },\n                    {\n                        withCredentials: true,\n                        headers: {\n                            'Content-Type': 'application/json',\n                            commentId: props.comment.commentId\n                        }\n                    }\n                );\n            } catch (err) {\n                console.log(err);\n                setText(props.post.text);\n            }\n        }\n        setEditable(!editable);\n    }\n\n    function viewProfile() {\n        if(props.comment.user.userId === currentUser.userId) {\n            history.push(\"/profile\");\n        }\n        else {\n            history.push({\n                pathname: '/ProfileAll',\n                state: {detail: props.comment.user.userId}\n            });\n        }\n    }\n\n    React.useEffect(() => {\n        let tempDate = new Date(props.comment.created);\n        tempDate.setHours(tempDate.getHours()+3,tempDate.getMinutes(),tempDate.getSeconds(),tempDate.getMilliseconds());\n        setDateTime(tempDate);\n\n        // Delete post render\n        // if (props.comment.user.userId === currentUser.userId) {\n        //     document.getElementById(\"deleteButton\" + props.comment.commentId).style.display = \"block\";\n        // }\n    },[]);\n\n    return (\n        <>\n        <div className=\"card p-0 my-1 mx-2\">\n            <div className=\"card-body d-flex flex-row pt-2 pb-0 px-1 mb-0\">\n                {/* \"https://cdn.vox-cdn.com/thumbor/G8A4RF-QWQl7jItQw93r402os_0=/1400x1050/filters:format(jpeg)/cdn.vox-cdn.com/uploads/chorus_asset/file/10816041/rick_and_morty_s02_still.jpg\" */}\n                <img style={style} src={\"/api/profile/searchUsers/\" + props.comment.user.userId}\n                    className=\"avatar rounded-circle mx-2\" \n                    alt=\"Cinque Terre\"\n                    onClick={viewProfile}/>\n                <div className=\"w-100\">\n                    <h6 className=\"card-text mb-0\" onClick={viewProfile} style={{cursor: \"pointer\"}}>{props.comment.user.firstName + \" \" + props.comment.user.lastName}</h6>\n                    <blockquote className=\"card-text p-0 m-0\">\n                        { !editable &&\n                            <p className=\"mb-0\">{text}</p>\n                        }\n                        { editable &&\n                            <textarea value={text} rows=\"3\" minLength=\"1\" maxLength=\"250\" className=\"form-control\" onChange={(evt) => {setText(evt.target.value)}}></textarea>\n                        }\n                    </blockquote>\n\n                </div>\n                {(props.comment.user.userId === currentUser.userId) &&\n                    <>\n                        <div onClick={updatePost} id={\"updateButton\" + props.comment.commentId} style={{cursor: \"pointer\"}}><i className=\"far fa-edit mr-2\"></i></div>\n                        <div onClick={deleteComment} id={\"deleteButton\" + props.comment.commentId} style={{cursor: \"pointer\"}} className=\"pr-2\"><i className=\"far fa-trash-alt\"></i></div>\n                    </>\n                }\n            </div>\n            <div className=\"card-body p-1\">\n                <div className=\"row\">\n                    {/*<div className=\"col-4 m-2\">*/}\n                    {/*    <FontAwesomeIcon className=\"mx-2\" icon={faGlassCheers} />{8}*/}\n                    {/*</div>*/}\n                    <div className=\"col-11 text-right\">\n                        <p className=\"card-text text-secondary\"><small><i className=\"far fa-clock pr-2\"></i><TimeAgo date={props.comment.created}/></small></p>\n                        {/*<p className=\"card-text text-secondary\"><small><i className=\"far fa-clock pr-2\"></i>{dateTime.toLocaleString(\"en-GB\",{timeZone: \"UTC\"})}</small></p>*/}\n                    </div>\n                </div>\n            </div>\n        </div>\n    </>\n    );\n}\n\nexport default Comment;"]},"metadata":{},"sourceType":"module"}